webpackJsonp([36],{"7OQr":function(e,t,a){var r=a("gHiP");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("033c0b68",r,!0)},EkEx:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{type:"primary"}},[e._v("初始化")])],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("组织架构")])]),e._v(" "),a("div",[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),e._v(" "),a("el-tree",{ref:"departTreer",staticClass:"filter-tree",attrs:{data:e.documentTree,props:e.defaultProps,"node-key":"id","highlight-current":"","default-expand-all":"","filter-node-method":e.filterNode,"render-content":e.renderContent},on:{"node-click":e.getNodeData}})],1)])],1),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("组织相关")])]),e._v(" "),a("div",[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"用户管理",name:"first"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"标签或code"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.userHandleFilter(t)}},model:{value:e.userQuery.search,callback:function(t){e.$set(e.userQuery,"search",t)},expression:"userQuery.search"}}),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:e.userHandleFilter}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:e.userHandleAdd}},[e._v("添加用户")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.userData,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"账户",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"备注",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"100",fixed:"right",align:"center"}})],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{"margin-top":"10px"}},[a("el-pagination",{attrs:{"current-page":e.userQuery.currentPage,"page-sizes":[10,20,30,40],"page-size":e.userQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.userQuery.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"岗位管理",name:"second"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"标签或code"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.posHandleFilter(t)}},model:{value:e.posQuery.search,callback:function(t){e.$set(e.posQuery,"search",t)},expression:"posQuery.search"}}),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:e.posHandleFilter}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:e.posHandleAdd}},[e._v("添加")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.positionData,border:"",fit:"","highlight-current-row":""},on:{"row-click":e.openDetails}},[a("el-table-column",{attrs:{prop:"name",label:"职位",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"num",label:"编码",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updName",label:"最后更新人",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updUser",label:"最后更新人ID",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updTime",label:"最后更新时间",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"100",fixed:"right",align:"center"}})],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{"margin-top":"10px"}},[a("el-pagination",{attrs:{"current-page":e.posQuery.currentPage,"page-sizes":[10,20,30,40],"page-size":e.posQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.posQuery.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)],1)])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"标签或code"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleFilter(t)}},model:{value:e.userQuery.search,callback:function(t){e.$set(e.userQuery,"search",t)},expression:"userQuery.search"}}),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("添加")])],1),e._v(" "),a("el-table",{ref:"multipleTable",attrs:{data:e.gridData,"tooltip-effect":"dark",border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"账户",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"备注",width:"180",align:"center"}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"创建岗位",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"职位",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入职位"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编码",prop:"num"}},[a("el-input",{attrs:{placeholder:"请输入编码"},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancel("form")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.create("form")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},NgfM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),i=a.n(r),n=a("mTp8"),l=a("NYxO"),s=1e3;t.default={name:"depart",data:function(){return{filterText:"",documentTree:[],defaultProps:{children:"children",label:"name"},listQuery:{name:void 0},userQuery:{currentPage:1,pageSize:20,search:void 0,departmentId:null,total:null,mark:1},posQuery:{currentPage:1,pageSize:20,search:void 0,parentId:null,total:null},addQuery:{currentPage:1,pageSize:20,search:void 0,departmentId:null,total:null,mark:0},activeName:"first",search:"",userData:[],positionData:[],listLoading:!1,currendId:null,gridData:[],dialogTableVisible:!1,dialogFormVisible:!1,form:{name:"",num:"",parentId:null},rules:{name:[{required:!0,message:"请输入编码",trigger:"blur"},{min:3,max:20,message:"长度在3到20个字符",trigger:"blur"}],num:[{required:!0,message:"请输入职位",trigger:"blur"},{min:3,max:20,message:"长度在3到20个字符",trigger:"blur"}]},multipleSelection:[],currentRow:null}},watch:{filterText:function(e){this.$refs.departTreer.filter(e)}},created:function(){this.getList()},computed:i()({},a.i(l.b)(["elements"])),methods:{getList:function(){var e=this;a.i(n.a)(this.listQuery).then(function(t){e.documentTree=t,console.log(e.documentTree)})},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},getNodeData:function(e){var t=this;this.currendId=e.id,this.userQuery.departmentId=e.id,a.i(n.b)(this.userQuery).then(function(e){t.userData=e.data.rows,t.userQuery.total=e.data.total}),this.posQuery.parentId=e.id,a.i(n.c)(this.posQuery).then(function(e){t.positionData=e.data.rows,t.posQuery.total=e.data.total})},handleClick:function(e,t){},userHandleFilter:function(){var e=this;a.i(n.b)(this.userQuery).then(function(t){e.userData=t.data.rows})},posHandleFilter:function(){var e=this;a.i(n.c)(this.posQuery).then(function(t){e.positionData=t.data.rows})},handleSizeChange:function(e){this.userQuery.pageSize=e,this.posQuery.pageSize=e},handleCurrentChange:function(e){this.userQuery.currentPage=e,this.posQuery.currentPage=e},userHandleAdd:function(){var e=this;if(null==this.currendId)return this.$notify({title:"提示",message:"请先选择部门节点",type:"warning"}),!1;this.dialogTableVisible=!0,this.addQuery.departmentId=this.currendId,a.i(n.b)(this.addQuery).then(function(t){e.gridData=t.data.rows})},handleSelectionChange:function(e){this.multipleSelection=e},handleFilter:function(){var e=this;a.i(n.b)(this.userQuery).then(function(t){e.gridData=t.data.rows})},handleAdd:function(){for(var e=this,t="",r=0;r<this.multipleSelection.length;r++)r==this.multipleSelection.length-1?t+=this.multipleSelection[r].id:t+=this.multipleSelection[r].id+",";a.i(n.d)(t,this.currendId).then(function(){e.dialogTableVisible=!1,a.i(n.b)(e.userQuery).then(function(t){e.userData=t.data.rows}),e.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3})})},posHandleAdd:function(){if(null==this.currendId)return this.$notify({title:"提示",message:"请先选择部门节点",type:"warning"}),!1;this.resetTemp(),this.dialogFormVisible=!0},create:function(e){var t=this;this.$refs[e].validate(function(e){if(t.form.parentId=t.currendId,!e)return!1;a.i(n.e)(t.form).then(function(){t.dialogFormVisible=!1,a.i(n.c)(t.posQuery).then(function(e){t.positionData=e.data.rows}),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})})},cancel:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields()},resetTemp:function(){this.form={name:void 0,num:void 0}},append:function(e){var t={id:s++,name:"testtest",children:[]};e.children||this.$set(e,"children",[]),e.children.push(t)},remove:function(e,t){var a=e.parent,r=a.data.children||a.data,i=r.findIndex(function(e){return e.id===t.id});r.splice(i,1)},openDetails:function(e){this.currentRow=e.id},relatedUser:function(){var e=this;if(null==this.currentRow)return this.$notify({title:"提示",message:"请先选择岗位",type:"warning"}),!1;this.dialogTableVisible=!0,this.addQuery.departmentId=this.currendId,a.i(n.b)(this.addQuery).then(function(t){e.gridData=t.data.rows})},renderContent:function(e,t){var a=this,r=t.node,i=t.data;t.store;return e("span",{class:"custom-tree-node"},[e("span",[r.label]),e("span",[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.append(i)}}},["添加"]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.remove(r,i)}}},["删除"])])])}}}},gHiP:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".el-tree-node__content{-ms-flex-align:center;height:26px;cursor:pointer}.custom-tree-node,.el-tree-node__content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;align-items:center}.custom-tree-node{-webkit-box-flex:1;-ms-flex:1 1 0%;flex:1 1 0%;-ms-flex-align:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;font-size:14px;padding-right:8px}",""])},hCox:function(e,t,a){function r(e){a("7OQr")}var i=a("VU/8")(a("NgfM"),a("EkEx"),r,null,null);e.exports=i.exports},mTp8:function(e,t,a){"use strict";function r(e){return a.i(d.a)({url:"/api/admin/depart/tree",method:"get",params:e})}function i(e){return a.i(d.a)({url:"/api/admin/user/departId/users",method:"post",params:e})}function n(e){return a.i(d.a)({url:"/api/admin/depart/search",method:"post",params:e})}function l(e,t){return a.i(d.a)({url:"/api/admin/depart/relation/user?userId="+e+"&departmentId="+t,method:"post"})}function s(e){return a.i(d.a)({url:"/api/admin/depart/update?isPost=2",method:"post",data:e})}function o(e){return a.i(d.a)({url:"/api/admin/depart/get/"+e,method:"get"})}function u(e){return a.i(d.a)({url:"/api/admin/depart/remove/"+e,method:"delete"})}t.a=r,t.b=i,t.c=n,t.d=l,t.e=s,t.f=o,t.g=u;var d=a("Vo7i")}});
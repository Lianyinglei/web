webpackJsonp([46],{"8Iid":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("el-row",[a("el-col",{attrs:{gutter:24}},[a("div",{staticClass:"filter-container",staticStyle:{"padding-bottom":"0"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"姓名或账户"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleFilter(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),e.userManager_btn_add?a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:e.handleCreate}},[e._v("添加")]):e._e()],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"序号",width:"80",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{width:"110",align:"center",label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"200",align:"center",label:"账户"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.username))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sex))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"150",align:"center",label:"手机号码"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.mobilePhone))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"180",align:"center",label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.crtUser))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"180",align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.crtTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"180",align:"center",label:"最后更新人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.updUser))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"180",align:"center",label:"最后时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.updTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.userManager_btn_edit?a("el-button",{attrs:{size:"small",type:"success"},on:{click:function(a){e.handleUpdate(t.row)}}},[e._v("编辑\n                    ")]):e._e(),e._v(" "),e.userManager_btn_del?a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v("删除\n                    ")]):e._e()]}}])})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,width:"80%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("el-col",[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账户",prop:"username"}},["create"==e.dialogStatus?a("el-input",{staticStyle:{width:"215px"},attrs:{"suffix-icon":"/assets/icon/aaa.png",placeholder:"请输入账户"},on:{blur:function(t){e.checkUser(e.form.username)}},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[a("template",{attrs:{slot:"append"},slot:"append"},[e._v("@chemclin.com")])],2):a("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入账户",readonly:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},e._l(e.sexOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号码",prop:"mobilePhone"}},[a("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入手机号"},model:{value:e.form.mobilePhone,callback:function(t){e.$set(e.form,"mobilePhone",t)},expression:"form.mobilePhone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"固定电话",prop:"telPhone"}},[a("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入电话号码"},model:{value:e.form.telPhone,callback:function(t){e.$set(e.form,"telPhone",t)},expression:"form.telPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"APP登录"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.chooseRole},model:{value:e.form.allowApp,callback:function(t){e.$set(e.form,"allowApp",t)},expression:"form.allowApp"}},e._l(e.allowAppOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"角色权限",prop:"groupId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.groupId,callback:function(t){e.$set(e.form,"groupId",t)},expression:"form.groupId"}},e._l(e.roleOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"部门选择",prop:"departmentId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.departmentId,callback:function(t){e.$set(e.form,"departmentId",t)},expression:"form.departmentId"}},e._l(e.depOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-col",[a("el-form-item",{attrs:{label:"地址"}},[a("el-tree",{ref:"areaTree",staticClass:"filter-tree",attrs:{"check-strictly":"",data:e.treeData,"show-checkbox":"","node-key":"id","highlight-current":"",props:e.defaultProps,"default-expand-all":""}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancel("form")}}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.create("form")}}},[e._v("确 定")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.update("form")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},NlWJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),l=a.n(n),r=a("TG9w"),i=a("NYxO");t.default={name:"user",data:function(){return{form:{username:void 0,name:void 0,email:"",sex:"男",allowApp:"1",password:void 0,description:void 0,groupId:"",addressTree:1,mobilePhone:"",telPhone:"",departmentId:""},rules:{name:[{required:!0,message:"请输入用户",trigger:"blur"},{min:2,max:20,message:"长度在 3 到 100 个字符",trigger:"blur"}],username:[{required:!0,message:"请输入账户",trigger:"blur"},{min:3,max:100,message:"长度在 3 到 100 个字符",trigger:"blur"}],groupId:[{required:!0,message:"请选择角色",trigger:"change"}],departmentId:[{required:!0,message:"请选择部门",trigger:"change"}],mobilePhone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:function(e,t,a){if(!t)return a(new Error("手机号不能为空"));var n=/^1[3|4|5|7|8][0-9]\d{8}$/;if(console.log(n.test(t)),!n.test(t))return a(new Error("请输入正确的手机号"));a()},trigger:"blur"}]},list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,name:void 0},sexOptions:["男","女"],allowAppOptions:[{value:"1",label:"支持"},{value:"2",label:"不支持"}],roleOptions:[],depOptions:[],dialogFormVisible:!1,dialogStatus:"",userManager_btn_edit:!1,userManager_btn_del:!1,userManager_btn_add:!1,textMap:{update:"编辑",create:"创建"},tableKey:0,treeData:[],defaultProps:{children:"children",label:"name"},flag:!0,lat:!0}},created:function(){this.getList(),this.getInfom(),this.userManager_btn_edit=this.elements["userManager:btn_edit"],this.userManager_btn_del=this.elements["userManager:btn_del"],this.userManager_btn_add=this.elements["userManager:btn_add"]},computed:l()({},a.i(i.b)(["elements"])),methods:{getList:function(){var e=this;this.listLoading=!0,a.i(r.b)(this.listQuery).then(function(t){e.list=t.data.data.rows,e.total=t.data.data.total,e.listLoading=!1})},getInfom:function(){var e=this;a.i(r.c)().then(function(t){e.treeData=t.data.areaTree}),a.i(r.d)().then(function(t){e.roleOptions=t.data}),a.i(r.e)().then(function(t){e.depOptions=t.data})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},handleCreate:function(){this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0},checkUser:function(e){var t=this;a.i(r.f)(e).then(function(e){if(e.data>0)return t.flag=!1,t.$message({message:"该用户名已存在",type:"warning"}),!1;t.flag=!0})},checkObj:function(e){var t=this;console.log(e),a.i(r.g)(e).then(function(e){if(1==e.data)return t.lat=!1,t.$message({message:"该邮箱已存在",type:"warning"}),!1;t.lat=!0})},chooseRole:function(){},chooseDep:function(){},handleUpdate:function(e){var t=this;this.dialogFormVisible=!0,this.dialogStatus="update",a.i(r.h)(e.id).then(function(e){t.form.id=e.data.userInfo.id,t.form.name=e.data.userInfo.name,t.form.username=e.data.userInfo.username,t.form.sex=e.data.userInfo.sex,t.form.groupId=e.data.groupId,t.form.departmentId=e.data.departmentList[0].id,t.form.mobilePhone=e.data.userInfo.mobilePhone,t.form.telPhone=e.data.userInfo.telPhone,t.form.allowApp=e.data.userInfo.allowApp}),console.log(this.form.mobilePhone)},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.i(r.i)(e.id).then(function(){t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3});var a=t.list.indexOf(e);t.list.splice(a,1)})})},create:function(e){var t=this,n=this.$refs;this.form.username=this.form.username+"@chemclin.com",n[e].validate(function(e){return!!e&&(0==t.flag?(t.$message({message:"该用户名已存在",type:"warning"}),!1):""==t.role?(t.$message({message:"请选择角色",type:"warning"}),!1):""==t.dep?(t.$message({message:"请选择部门",type:"warning"}),!1):void a.i(r.j)(t.form).then(function(){t.dialogFormVisible=!1,t.getList(),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}).catch(function(){return!1}))})},cancel:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields()},update:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;a.i(r.k)(t.form).then(function(){t.getList(),t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3}),t.dialogFormVisible=!1})})},resetTemp:function(){this.form={username:void 0,name:void 0,sex:"男",allowApp:"1",groupId:"",addressTree:1,mobilePhone:"",telPhone:"",departmentId:""}}}}},cgTB:function(e,t,a){function n(e){a("zyaW")}var l=a("VU/8")(a("NlWJ"),a("8Iid"),n,null,null);e.exports=l.exports},"z/+g":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".el-dialog{width:80%}",""])},zyaW:function(e,t,a){var n=a("z/+g");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("5aea8624",n,!0)}});